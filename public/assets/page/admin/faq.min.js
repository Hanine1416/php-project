$(document).ready(function(){var n=$(".box"),e=DOMPurify.sanitize($("#box-msg-yes").text());n.find("#box-confirm").html(e+" <span></span>");e=i($("#box-msg-no"));n.find("#box-cancel").text(e);var a,t=$("#formFaq"),s=$("#newFaqBtn"),o=$("#editFaqBtn");function i(e){if("string"!=typeof e)return e;var a=new RegExp(`<(${["p","a","b","i","em","strong","br","input","span","li","ul","div","img"].join("|")})[^>]*>`,"gi"),t=new RegExp(`(\\s(${["href"].join("|")})="[^"]*")`,"gi");return e=(e=e.replace(a,"")).replace(t,"")}function r(){var e=$("#faq-question"),a=tinyMCE.get("faq-answer").getContent({format:"html"}),t=$("#faq-answer"),n=$("#questionError"),s=$("#answerError"),o=!0;return e.val().length<1&&(o=!1,n.removeClass("hide")),a.length<1&&(o=!1,s.removeClass("hide")),e.on("keyup",function(){$(this).val().length<1?n.removeClass("hide"):n.addClass("hide")}),t.on("keyup",function(){$(this).val().length<1?s.removeClass("hide"):s.addClass("hide")}),o?{answer:a,question:e.val()}:null}a="#faq-answer",tinyMCE.init({max_chars:200,default_link_target:"_blank",menubar:!1,selector:a,statusbar:!0,forced_root_block:!1,ui_container:".modal",plugins:" print preview fullpage searchreplace autolink directionality  visualblocks visualchars fullscreen  link  table charmap hr pagebreak nonbreaking anchor toc insertdatetime advlist lists wordcount imagetools textpattern help",toolbar1:" bold italic underline | link ",init_instance_callback:function(e){$(".mce-tinymce").show("fast"),$(e.getContainer()).find(".mce-path").css("display","none"),$(e.getContainer()).find(".tox-statusbar__branding").css("display","none")}}),$(document).on("focusin",function(e){$(e.target).closest(".mce-window").length&&e.stopImmediatePropagation()}),$(document).on("focusin",function(e){$(e.target).closest(".tox-textfield").length&&e.stopImmediatePropagation()}),$("#formFaqPage").on("submit",function(e){$(this).hasClass("allowSubmit")||e.preventDefault()}),$(document).on("click","#formFaqPage .btn-submit",function(){$("#formFaqPage").addClass("allowSubmit").submit()}),$(document).on("click",".preview-faq-btn:not(.complete-url)",function(){var n=$(".tabsList");n.html("");var e=$("#sortable>li"),a=$(".preview-faq-modal");$.each(e,function(e,a){var t=DOMPurify.sanitize($(a).find(".faq-question").text()),a=DOMPurify.sanitize($(a).find(".faq-answer").val());n.append('<div class="tile-tab"><a class="title-accordion">'+t+' <i class="expand-tile" data-toggle="tooltip" data-placement="bottom"></i><i class="collapse-tile" data-toggle="tooltip" data-placement="bottom" ></i></a><div class="hiddenDescription content"><div class="descriptionContent">'+a+"</div></div></div>")}),a.show().addClass("active")}),$(document).on("click",".publish-faq-btn",function(){var e=$("#sortable>li"),a=$(".publish-faq-btn").data("url"),t={faqs:[]};$.each(e,function(e,a){a=$(a).data("token");t.faqs.push({token:a,newOrder:e})}),console.log(t),t&&$.ajax({method:"POST",url:a,data:t,dataType:"JSON",success:function(e){e.success?$(".btn-cancel-preview").click():showErrorBox(!1,"an error occurred please repeat the process")}})}),$(document).on("click",".btn-save-faq:not(.loading)",function(){s.removeClass("hide"),o.addClass("hide");var e=t.data("url"),a=r();a.order=$("#sortable>li").length+1,a&&$.ajax({method:"POST",url:e,data:a,dataType:"JSON",beforeSend:function(){s.addClass("loading")},success:function(e){var a,t;(e=i(e)).success?(a=i(e.faq.token),t=i(e.editUrl),i(e.faq.answer),t='<li class="ui-state-default" data-token="'+a+'"  data-order="'+e.faq.order+'"> <p class="faq-question" >'+e.faq.question+'</p><input type="hidden" name="faq['+a+']" class="faq-answer"><i class="edit-faq" data-url="'+t+'" ></i><i class="delete-faq" data-url ="'+t+'"></i><i class="sort-faq"></i></li>',t=DOMPurify.sanitize(t),$("#sortable").append(t),$(".btn-reset-form").click()):showErrorBox(!1,"an error occurred please repeat the process"),s.removeClass("loading")}})}),$(document).on("click",".edit-faq",function(e){e.preventDefault(),$(".edit-faq.selected").removeClass("selected"),$(this).addClass("selected");var a=$(this).closest("li").find(".faq-question").html(),t=$(this).closest("li").find(".faq-answer").val(),e=$("#formFaq");e.find("#faq-question").val(a),e.find("#faq-answer").val(t),tinymce.get("faq-answer").setContent(t),s.addClass("hide"),o.removeClass("hide"),$("#openModal").click()}),$(document).on("click","#editFaqBtn:not(.loading)",function(){var n=$(".edit-faq.selected"),s=n.parent(),e=n.data("url"),a=r();o.addClass("loading"),a&&$.ajax({method:"POST",url:e,data:a,dataType:"JSON",success:function(e){var a=i(e.faq.question),t=i(e.faq.answer);e.success?(s.find(".faq-question").text(a),s.find(".faq-answer").val(t)):showErrorBox(!1,"an error occurred please repeat the process"),$(".btn-reset-form").click(),o.removeClass("loading"),n.removeClass("selected")}})}),$(document).on("click",".delete-faq:not(.loading)",function(e){e.preventDefault();var a=$(this),t=a.data("url");n.attr("class","box active confirm-info"),n.find(".confirm-msg").text($("#delete-faq-msg").text()),n.find("#box-cancel").css("display",""),n.on("click","#box-confirm",function(){$(this).prev().hide(),$.ajax({url:t,method:"post",dataType:"json",beforeSend:function(){a.addClass("loading")},success:function(e){e.success?a.closest("li").remove():showErrorBox(!1,"an error occurred please repeat the process"),a.removeClass("loading")}}),n.removeClass("active")}),n.on("click","#box-cancel",function(){n.attr("class","box"),n.off("click")})}),$(".btn-reset-form").on("click",function(){$(".editRow").removeClass("editRow"),s.removeClass("hide"),o.addClass("hide"),$(".error:not(.hide)").addClass("hide"),t.find("#faq-question").val(""),tinymce.get("faq-answer").setContent("")}),$(document).on("click touchstart",".accordion .title-accordion",function(e){var a=$(this);a.hasClass("active")?(a.removeClass("active"),a.next().hide()):(a.next().show(),$(".accordion .title-accordion.active").removeClass("active").next().hide(),a.addClass("active")),e.preventDefault()}),$("#sortable").sortable({connectWith:".connectedSortable"})});