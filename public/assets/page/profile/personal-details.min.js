function profileBlockChanged(e){var t=!1;return $.each(e.find("select[data-value],input[data-value]"),function(e,a){if(t="checkbox"===$(a).attr("type")&&$(a).prop("checked")!=$(a).data("value")||$(a).val()!=$(a).data("value")&&(null!==$(a).val()||""!=$(a).data("value"))&&"hidden"!==$(a).attr("type")&&"checkbox"!==$(a).attr("type")?!0:t)return!1}),t=0<$(".dropzone").length&&0<$(".dropzone")[0].dropzone.getAcceptedFiles().length?!0:t}Dropzone.autoDiscover=!1,$(document).ready(function(){$(".dropzone").each(function(e,a){$(a).find(".upload-btn").on("click",function(e){e.preventDefault(),$(a).click(),$(this).blur()});var t="g_"+$(a).data("field"),i=new Dropzone(a,{url:window.location.pathname,parallelUploads:100,maxFiles:1,paramName:t,thumbnailHeight:120,thumbnailWidth:100,addRemoveLinks:!0,resizeWidth:100,resizeHeight:120,dictDefaultMessage:$(a).data("drag-msg"),dictRemoveFile:$(a).data("delete-msg"),acceptedFiles:".rtf,.doc, .docx, .png , .pages, .jpg,.pdf",autoProcessQueue:!1}).on("complete",function(e){i.removeFile(e)}).on("addedfile",function(e){var a=e.name.split(".").pop();$(".dropzone").removeClass("file-img"),$(".url-and-upload-fields").removeClass("warning"),$(".url-file-container .error").remove(),"png"!==a&&"jpg"!==a&&"jpeg"!==a&&(this.emit("thumbnail",e,"/assets/img/file-icon/file.png"),$(".dropzone").addClass("file-img")),$("#update-detail-btn").attr("disabled",!1),1e6<e.size&&(showErrorBox($("#max-size-file-upload").text()),i.removeFile(e))}).on("removedfile",function(){$("#update-detail-btn").attr("disabled",!profileBlockChanged($("#edit-details-form")))})}),$("#dropzone-upload").hasClass("has-file")&&$(".dropzone").append('<div class="dz-preview dz-file-preview">\n  <div class="dz-image"><img data-dz-thumbnail src="/assets/img/file-icon/file.png"/></div>\n<a class="dz-remove delete-img" href="javascript:undefined;" >'+$(".dropzone").data("delete-msg")+"</a> </div>"),$(".delete-img").on("click",function(){$(".dz-file-preview").remove(),$("#dropzone-upload").removeClass("has-file");var e=$("#dropzone-upload").data("drag-file-id");$.ajax({url:baseUrl+"/update-profile-file-provided",method:"post",data:{fileId:e},dataType:"JSON",success:function(){}})});var a=$("#details_country"),d=$("#details_mobile");a.select2({placeholder:"",dropdownParent:a.parent()}),$(".cancelRequest").on("click",function(){return!!confirm($("#cancelRequest").text())&&($(".cancelRequest").attr("disabled","disabled"),!0)}),$(document).on("change keyup","#edit-details-form select,#edit-details-form input",function(){var e=$(this).closest("form");e.find("#update-detail-btn").attr("disabled",!profileBlockChanged(e))}),$(document).on("click","#update-detail-btn",function(e){e.preventDefault();var t=$(this),i=t.closest("form"),n=i.find(".validate");n.removeClass("warning").parent().find(".error").remove(),n.parent().find(".error-phone").remove();var o=!0;if($.each(n,function(e,a){var t;null!==$(a).val()&&"undefined"!==$(a).val()&&""!==$(a).val()||!$(a).is(":visible")||$(a).hasClass("empty")||($(a).addClass("warning"),$(a).parent().hasClass("country")?(t=DOMPurify.sanitize($(a).data("invalid")),$(a).parent().append('<span class="error" style="position: relative;">'+t+"</span>")):(t=DOMPurify.sanitize($(a).prop("title")),$(a).parent().append('<span class="error" style="position: relative;">'+t+"</span>")),o=!1)}),0<$("#details_url").length&&(0<(r=$("#details_url")).val().length&&!ValidURL(r.val())&&(l=DOMPurify.sanitize(r.attr("data-no-url")),r.addClass("warning").parent().append('<span class="error">'+l+"</span>"),o=o&&!1)),d.hasClass("warning")||validatePhoneNumber(d,a.find("option:selected").data("st"))){let a=$("#current_region").data("region");var l,r,e=$("#details_url"),n=$(".url-and-upload-fields");6!==a&&0!==a&&9!==a||(n.removeClass("warning").parent().find(".error").remove(),l=0===$(".dropzone")[0].dropzone.getAcceptedFiles().length,(null===e.val()||"undefined"===e.val()||""===e.val())&&l?(e=DOMPurify.sanitize(e.prop("title")),n.addClass("warning").parent().append('<span class="error" style="position: initial">'+e+"</span>"),o=!1):ValidURL(r.val())&&($(".url-and-upload-fields").removeClass("warning"),$(".url-file-container .error").remove())),o&&(r=i.serializeArray(),$.ajax({url:i.attr("action"),method:"PUT",data:r,dataType:"JSON",beforeSend:function(){t.addClass("loading"),i.closest("fieldset").attr("disabled",!0)},success:function(e){if(e.success)if(7!==a&&4!==a&&6!==a&&11!==a&&9!==a||1===a)$.each(i.find("[data-value]"),function(e,a){$(a).data("value",a.value)}),t.attr("disabled",!0),window.location=i.attr("action");else if(0<$(".dropzone")[0].dropzone.getAcceptedFiles().length){let e=new FormData;e.append("userFile",$(".dropzone")[0].dropzone.getAcceptedFiles()[0]),$.ajax({url:baseUrl+"/upload-file",method:"post",data:e,processData:!1,contentType:!1,success:function(e){e.success?($.each(i.find("[data-value]"),function(e,a){$(a).data("value",a.value)}),t.attr("disabled",!0),window.location=i.attr("action")):showErrorBox(e.message)}})}else $.each(i.find("[data-value]"),function(e,a){$(a).data("value",a.value)}),t.attr("disabled",!0),window.location=i.attr("action");else showErrorBox(e.message);t.removeClass("loading"),i.closest("fieldset").attr("disabled",!1)}}))}}),$(document).on("change keyup","input,select",function(){($(this).val()&&$(this).hasClass("warning")||"checkbox"===$(this).attr("type")&&$(this).is(":checked"))&&$(this).removeClass("warning").parent().find(".error").remove(),$(this).attr("id")===d.attr("id")&&0<$(this).val().length&&validatePhoneNumber($(this),a.find("option:selected").data("st"))}),$('[data-toggle="popover"]').popover().on("show.bs.popover",function(){var e=$(this);$.each($(".popover.in"),function(){e!==$(this)&&$(this).prev().click()})}),$("body").on("click touch",function(e){"popover"!==$(e.target).data("toggle")&&0===$(e.target).parents(".popover.in").length&&$('[data-toggle="popover"]').popover("hide")})});