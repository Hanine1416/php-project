!function(e){"use strict";var t=$(".box");function i(o,a,e){0<o.length&&$.ajax({url:$("#share-book-modal").data("url"),method:"POST",data:{emails:o,message:a,isbn:e},success:function(o){o.success&&(t.removeClass("active confirm-info"),t.off("click"),$("body").removeClass("modal-open"),$("#share-book-modal #step1").removeClass("active"),$("#share-book-modal #step2").addClass("active"))}})}$("#share-book-modal").on("shown.bs.modal",function(o){var a=document.querySelector("#emails-input"),a=e(a);window.emailsInput=a}),$(document).on("click","#share-book, .share-book",function(){var o=$(this).attr("data-title"),a=$(this).attr("data-subtitle"),e=DOMPurify.sanitize($(this).attr("data-isbn")),t=$(this).attr("data-editionNumber");e&&($("#share-book-modal .book_title").text(o),$("#share-book-modal .book_subtitle").text(a),t&&$("#share-book-modal .edition_num").text($("#share-book-modal .edition_num").attr("data-text-edition")+" "+t),$("#share-book-modal .popup-title").attr("data-book_isbn",e),t=(t=DOMPurify.sanitize($("#"+e).find("img").attr("src")))||DOMPurify.sanitize($("#shared-"+e).find("img").attr("src")),$("#share-book-modal .cover").attr("src",t),(t=$("#share-book-modal .dot-share-product-popup").find("a").attr("data-link"))&&((t=t.split("/")).pop(),t.push(e),t=t.join("/"),$("#share-book-modal .dot-share-product-popup").find("a").attr("data-link",t)))}),$(".share-btn").on("click",function(){const o=emailsInput.getValue();var a=$("#msgShare").val(),e=$("#share-book-modal .popup-title").attr("data-book_isbn");0===o.length&&0===$(".email-chip.invalid").length?($(".error-invalid-mail").addClass("hidden"),$(".error-no-mail").removeClass("hidden"),$("#emails-input .emails-input,.error-no-mail").addClass("warning")):0<$(".email-chip.invalid").length?($(".error-no-mail").addClass("hidden"),$(".error-invalid-mail").removeClass("hidden"),$("#emails-input .emails-input,.error-invalid-mail").addClass("warning")):($(".error-no-mail").addClass("hidden"),$("#emails-input .emails-input").removeClass("warning"),0===$("#msgShare").val().length?(t.find("#box-confirm").text($("#share-msg-yes").text()),t.find("#box-cancel").text($("#box-msg-yes").text()),t.attr("class","box active confirm-info"),t.find(".confirm-msg").text($("#no-share-msg").text()),t.on("click","#box-cancel",function(){i(o,a,e)}),t.on("click","#box-confirm",function(){t.removeClass("active confirm-info"),t.off("click"),$("body").removeClass("modal-open")})):i(o,a,e))}),$("#share-book-modal").on("hidden.bs.modal",function(){document.getElementById("emails-input").innerHTML="",$("#share-book-modal .cover").attr("src",""),$("#share-book-modal .detailDescription .book_title, #share-book-modal .detailDescription .book_subtitle,#share-book-modal .detailDescription .edition ").text(""),$("#msgShare").val(""),$("#share-book-modal #step1").addClass("active"),$("#share-book-modal #step2").removeClass("active"),$(".error-no-mail, .error-invalid-mail").addClass("hidden");var o=$(".box");o.find("#box-confirm").text($("#box-msg-yes").text()),o.find("#box-cancel").text($("#box-msg-no").text())}),$("#add_mail_btn").on("click",function(){var o=jQuery.Event("keypress");o.which=44,$(document).trigger(o)}),$(document).on("click",".continue_browsing_btn",function(){$("#share-book-modal").modal("hide")})}(window.lib.EmailsInput,window.lib.utils.random);